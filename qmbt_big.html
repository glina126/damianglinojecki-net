<!DOCTYPE html>
<html lang="en">
    <head>
      <title>Damian Glinojecki</title>
    	<meta charset="utf-8">
    	<meta name="viewport" content="width=device-width, initial-scale=1">
    	<meta name="description" content="Damians Personal projects page">
      <meta name="author" content="Damian Glinojecki">
    	<!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
          
        <!-- Optional theme -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
        
        <!-- jquery -->
        <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
        
        <link rel="stylesheet" type="text/css" href="custom_styles.css" />
        <link rel="stylesheet" type="text/css" href="animate_css.css" />
        <script src="viewportchecker.js"></script>
    
        <script>
            $(document).ready(function(){
                $('.visible-fadeIn').css("opacity","0").viewportChecker({
                    classToAdd: 'visible animated fadeIn',
                    offset: 100
                });
            });

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-62007869-2']);
          _gaq.push(['_trackPageview']);
        
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        
        </script>
    </head>

    <body data-spy="scroll" data-target="#ScrollerSpy">
      <header>
      <!-- navbar -->
      <nav class="navbar navbar-default ">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a href="/" class="navbar-brand">D.G.</a>
          </div>
          <div class="navbar-collapse collapse" id="navbar">
            <ul class="nav navbar-nav">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Projects <span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                  <li class="text-center"><a href="/laserCNC.html">
                    LaserCNC <br>
                    <img class="img-thumbnail" src="images/lasercnc.jpg" width="100%">
                  </a></li>
                  <li  class="text-center"><a href="/qmbt_big.html">
                    QMBT BIG <br>
                    <img class="img-thumbnail" src="images/qmbt_big_hq.jpg" width="100%">
                  </a></li>
                  <li  class="text-center"><a href="/qmbt_small.html">
                    QMBT <small>small</small> <br>
                    <img class="img-thumbnail" src="images/qmbt_small.jpg" width="100%">
                  </a></li>
                  <li  class="text-center"><a href="/amrr.html">
                    AMMR <br>
                    <img class="img-thumbnail" src="images/AMRR_train.jpg" width="100%">
                  </a></li>
                  <li  class="text-center"><a href="/under_construction.html">
                    MicroBit<small>328</small> <br>
                    <img class="img-thumbnail" src="images/microbit328.jpg" width="100%">
                  </a></li>
                  <li  class="text-center"><a href="/other_projects.html">
                    Smaller Projects <br>
                    <img class="img-thumbnail" src="images/other_projects.jpg" width="100%">
                  </a></li>
                </ul>
              </li>
              <li><a href="https://github.com/glina126">Github</a></li>
              <li><a href="https://www.linkedin.com/in/DamianGlinojecki">LinkedIn</a></li>
              <li><a href="aboutme.html">About Me</a></li>
            </ul>
          </div>
        </div>
      </nav>
    </header>
      
        <div class="jumbotron jumbotron-qmbt-big">
            <div class="container">
                <div class="col-md-12"></div>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-md-3" id="ScrollerSpy">
                    <ul class="nav nav-tabs nav-stacked affix-top" data-spy="affix">
                        <li class="active"><a href="#section-1">Introduction</a></li>
                        <li><a href="#section-2">A bit of a story</a></li>
                        <li><a href="#section-3">The Hardware</a></li>
                        <li><a href="#section-4">The Software</a></li>
                        <li><a href="#section-5">Conclusion/Future</a></li>
                    </ul>
                </div>
                <div class="col-md-9">
                    <h2 class="visible-fadeIn" id="section-1">Introduction</h2>
                    <p class="visible-fadeIn">R/C flying machines have always been my passion. Ever since I was a kid I had a passion for all flying things. In my early teens I joined an R/C flying club and with some help from my parents (along with my savings from birthdays and etc) I bought my first radio controlled airplane, it was a top wing trainer with a .40 size glow engine. I got hooked on the hobby more than ever.</p>
                    <img class="img-rounded img-responsive visible-fadeIn" src="images/pulse_xt.jpg" width="100%" alt="image of young me with the pulse xt">
                    <br>
                    <p class="visible-fadeIn">Traveling through time, I have built and flown many R/C planes. Quadcopters have recently became very popular in the R/C world. Naturally, it was time for me to build one, and so I did. The idea for QMBT was baked for a longer while. Given my nature, I wanted to build everything from scratch and by myself. Which lead to the QMBT <small>small</small> Though I soon realized that it was harder than it looked and decided to build a bigger version of the QMBT <small>small</small> which was the first sucessful quadcopter, all the way from custom hardware to custom software. The moment I saw it go up and actually keep level, was magic.</p>
                    <br>
                    <div class="row">
                      <div class="col-sm-4"></div>
                      <div class="col-sm-4">
                         <img class="img-rounded img-responsive visible-fadeIn" src="http://giant.gfycat.com/DefiantImpishCamel.gif">
                         <!-- http://gfycat.com/DefiantImpishCamel -->
                      </div>
                    </div>
                    <hr>
                    <h2 class="visible-fadeIn" id="section-2">A bit of a story</h2>
                    <p class="visible-fadeIn">Having not had so much success with the QMBT <small>small</small> it was time for a change with a bigger, easier to work with model. I bought all the necessary parts such as the frame, motors, props, batteries, receiver, ESCs and all the other small bits that go into a quadcopter. I was excited to test my new model, but I was quickly disappointed as my motors were not playing nice. This set me back a while... I did not give up. The budged for the project was certainly over the limit at this point, but I got very lucky with new motors from <a href="https://www.rotorgeeks.com">rotorgeeks.com</a>, thanks for the great deal David! The project was back up on its feet. It was finally time to start assembling my custom hardware and writing the software!</p>
                    <hr>
                    <h2 class="visible-fadeIn" id="section-3">Hardware</h2>
                    <p class="visible-fadeIn">The hardware was not very complicated for this model. Compared to the QMBT <small>small</small> it was a breeze. I didn't expect any unpredicted errors, crosstalk or any other anomalies, and I got what I expected. It was flawless except for the header hole sizes, they were a bit tight, but it wasn't a biggie.</p>
                    <p class="visible-fadeIn">The schematic was as straightforward as it gets, a simple atmega328p circuit, two voltage regulators, one 5V and the other 3V3, a logic level shifter, the MPU6050 IMU and a lot of headers. This time around there was no need to worry about motor control since the ESCs took care of that and there was no need to worry about communication as there was an R/C receiver on board. Having deigned the schematics and the printed circuit board, I was confident that this time around I could get it to fly.</p>
                    <h3 = class="visible-fadeIn">Schematic</h3>
                    <object data="QMBT_BIG_schematics.pdf" type="application/pdf" width="100%" height="500px">
                      <p>It appears you don't have a PDF plugin for this browser.
                      <a href="QMBT_BIG_schematics.pdf">click here to
                      download the schematic.</a></p>
                    </object>
                    <p class="visible-fadeIn">Note: the empty page was introduced on purpose. It was meant as a place holder for a 2.4Ghz module.</p>
                    <p class="visible-fadeIn">I have purposely used the atmega328p in this project since I could code in Arduino without having to reinvent the wheel with things such as the PID algorithm. This was a "sneaky" way of getting out of the hard low level coding and paying with bits. I wanted this project to go as smooth as possible which later unfortunately turned against me a little bit.<p>
                    <p class="visible-fadeIn">The atmega328p from the hardware perspective is simply not really good enough for being the brains for a quadcopter. Due to the limited number of interrupts I was unable to run the loop at the desired time interval of less than 10ms. Instead it ran at 33ms, which was rather slow. Also, another issue that I ran into was the 8bit registers and well, lack of 32bit architecture which I see as necessary for quadcopters due to the precision that you can obtain. Non the less, the hardware was set in stone and sent to OSHpark for fabrication.<p>
                    <h3 = class="visible-fadeIn">PCB</h3>
                    <img class="img-rounded img-responsive visible-fadeIn" src="images/qmbt_big_pcb.jpg" width="100%" alt="image of the PCB">
                    <hr>
                    <h2 class="visible-fadeIn" id="section-4">Software</h2>
                    <p class="visible-fadeIn">The software part of this project as very educating. I had to learn a lot about what goes into a quadcopter and what makes it tick. Since I did my own hardware, I had to learn how to set up the IMU properly along side with the proper filtering in the software. This was a big challenge but with counless readings and reseach I was able to achieve a very smooth output using the Complementary filter. Unfortunately, this filter is quiet simple and thus has its faults, mainly, it drifts over time. This was not such a big deal for the sake of getting the quadcopter to hover but I assume it would be much worse if it came to actually flying it with level assist.</p>
                    <p class="visible-fadeIn">There are many parameters that are required to be set just right for a quadcopter to take flight. I gained a lot of exposure in autonomous robotics and especially the PID algorithm. This algorithm is extremely neat in that it can "predict" which way the force will act and correct appropriately. I did use a library for this, and did not implement it myself but, in order to make the quadcopter I had to understand it to the bolts and nuts. This was by far the hardest parameter to tune.<p>
                    <p class="visible-fadeIn">Reading the R/C transmitter was very simple thanks to the built in pulseRead() function in the Arduino IDE. Though this method is blocking and resulted in a very sluggish loop. Since the quadcopter requires a minimum of 4 channels, each channel signal is at most 2ms in length and since we start sampling at a random time, the average time we have to wait is prolonged. Since the minimum signal length is 1ms and the max is 2ms, and we start sampling at any given time, the pulse in function can block the loop in the worst case for almost 4 ms. This is one of the problems with the atmega328p... not enought interrupts!</p>
                    <p class="visible-fadeIn">The relay function was very simple. Check the inputs, read the IMU and apply a small amount of math and apply the new values to the motors using the servoWrite() function, yet another function in the Arduino IDE. I wanted to keep the code side as easy as I could as the hardware was custom and debugging both hardware and software can be very painful.</p>
                    <a href="https://github.com/glina126/QMBT_copter">Link to the code on Github</a>
                    <hr>
                    <h2 class="visible-fadeIn" id="section-5">Bright Future of the Project</h2>
                    <p class="visible-fadeIn">The atmega328p microcontroller did not suffice. The quadcopter can hover but it is not really all that great. You can clearly see that the input from the rx is dirty due to the method used for reading it and that the loop is too slow. The ESCs can be updated at a rate of 400Hz and with this loop, the number was down at the 30Hz range. Thus, it was impossible to take advantage of the motors and hardware. </p>
                    <p class="visible-fadeIn">The project at this point is changing gears to a much better microcontroller for the application. Also, I am going away from the Arduino bubble and instead going to undertake this project under the Mbed environment. Currently I am slowly but steadily learning the Mbed platform. Once I am comfortable, I will be redoing the circuit. This actually will reduce it's size as the Cortex M0 microcontroller that I will be using runs at 3v3 as opposed to the high 5V that the atmega328p requires. This will eliminate the need of logic shifting between the MPU6050 and the microcontroller.</p>
                    <p>Over all I am very happy with the project as it was a major learning experiance that I would have not gained in any other way.<p>
                </div>
            </div>
        </div>
        <!-- Latest compiled and minified JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    </body>
</html>                           